set(folders sync_none_intent sync_libdarshan_none sync_none_none)
set(nodes 1 2 4)
foreach(node ${nodes})
    foreach (folder_base ${folders})
        set(folder ${folder_base}_${node}_40)
        string(REPLACE "_" ";" folder_list ${folder})
        message("-- Processing folder " ${folder} " for presentation")
        list(GET folder_list 0 SYNC)
        list(GET folder_list 1 profiler)
        list(GET folder_list 2 vol)
        list(GET folder_list 3 num_nodes)
        list(GET folder_list 4 procs_per_node)
        FILE(GLOB apps "${CMAKE_SOURCE_DIR}/presentation/logs/h5bench_confs/lassen/${folder}/*.json")
        foreach(app ${apps})
            #message(${app})
            get_filename_component(app_name ${app} NAME_WE)
            set(test_name presentation_h5bench_${folder}_${app_name})
            set(exec_path ${CMAKE_BINARY_DIR}/h5bench)
            add_test(NAME ${test_name} COMMAND ${exec_path} --debug ${app})
            if("${profiler}" STREQUAL "libdarshan")
                #message("-- ${profiler}" )
                set(exec_path ${CMAKE_BINARY_DIR}/h5bench)
                set(DARSHAN_LOG_DIR ${CMAKE_SOURCE_DIR}/presentation/logs/darshan/${folder}/${app_name})
                file(MAKE_DIRECTORY ${DARSHAN_LOG_DIR})
                set_property(TEST ${test_name} APPEND PROPERTY ENVIRONMENT "DARSHAN_LOG_DIR_PATH=${DARSHAN_LOG_DIR}")
            endif()
            set_property(TEST ${test_name} APPEND PROPERTY ENVIRONMENT "PATH=$ENV{PATH}:${CMAKE_BINARY_DIR}/bin:${CMAKE_BINARY_DIR}:${CMAKE_BINARY_DIR}/external/h5bench")
        endforeach()
    endforeach ()
endforeach ()